{% extends 'base.html.twig' %}

{% block title %}Cat√°logo de Libros{% endblock %}

{% block body %}
<div class="container" style="max-width: 1000px; margin: auto; padding: 20px;">
    <h2 style="text-align: center; margin-bottom: 20px;">üìö Cat√°logo de Libros</h2>

    <!-- Buscador -->
    <form method="get" action="{{ path('libro_catalogo') }}" style="margin-bottom: 20px; display: flex; gap: 10px;">
        <input type="text" name="titulo" placeholder="Buscar por t√≠tulo" value="{{ app.request.get('titulo') }}"
               style="flex:2; padding:8px; border:1px solid #ccc; border-radius:5px;">

        <select name="genero" style="flex:1; padding:8px; border:1px solid #ccc; border-radius:5px;">
            <option value="">Todos los g√©neros</option>
            {% for g in generos %}
                <option value="{{ g }}" {% if app.request.get('genero') == g %}selected{% endif %}>{{ g }}</option>
            {% endfor %}
        </select>

        <button type="submit" style="padding:8px 15px; background:#28a745; color:white; border:none; border-radius:5px;">
            üîç Buscar
        </button>
    </form>

    <!-- Cat√°logo -->
    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px;">
        {% for libro in libros %}
            <div style="border:1px solid #ccc; border-radius:10px; padding:15px; background:white; box-shadow:0 2px 5px rgba(0,0,0,0.1);">
                <img src="/uploads/libros/{{ libro.imagen }}" alt="{{ libro.titulo }}" style="width:100%; height:250px; object-fit:cover; border-radius:8px;">
                <h4 style="margin:10px 0 5px;">
                <a href="{{ path('libro_detalle', {id: libro.id}) }}" style="text-decoration:none; color:#007bff;">
                     {{ libro.titulo }}
                </a>
                </h4>
                <p style="margin:0; font-size:14px; color:#555;"><strong>Autor:</strong> {{ libro.autor }}</p>
                <p style="margin:0; font-size:14px; color:#555;"><strong>G√©nero:</strong> {{ libro.genero }}</p>
                <p style="margin:10px 0; font-size:13px; color:#333;">{{ libro.descripcion|slice(0,100) ~ '...' }}</p>
                <p style="margin:0; font-size:14px;">
                    <strong>Estado:</strong>
                    {% if libro.estado.value == 'Disponible' %}
                        <span style="color:green;">‚úî {{ libro.estado.value }}</span>
                    {% else %}
                        <span style="color:red;">‚úò {{ libro.estado.value }}</span>
                    {% endif %}
                </p>
            </div>
        {% else %}
            <p style="grid-column:1/-1; text-align:center;">No se encontraron libros con los filtros seleccionados.</p>
        {% endfor %}
    </div>
</div>
{% endblock %}
